<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel ‚Äî Altyn Biye</title>
  <link rel="stylesheet" href="styles/base.css">
  <style>
    :root {
      --sidebar-w: 240px
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0
    }

    body {
      display: flex;
      min-height: 100vh;
      background: #F4F6FA;
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      color: #1A1A1A
    }

    /* SIDEBAR */
    .sidebar {
      width: var(--sidebar-w);
      background: #1A1A1A;
      color: #fff;
      display: flex;
      flex-direction: column;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      z-index: 10
    }

    .sidebar-logo {
      padding: 1.5rem 1.2rem;
      border-bottom: 1px solid rgba(255, 255, 255, .08)
    }

    .sidebar-logo .name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.5rem;
      color: #D4A843;
      letter-spacing: .05em
    }

    .sidebar-logo .sub {
      font-size: .65rem;
      letter-spacing: .2em;
      text-transform: uppercase;
      color: rgba(255, 255, 255, .35);
      margin-top: 2px
    }

    .sidebar-nav {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto
    }

    .nav-section {
      padding: .5rem 1.2rem .3rem;
      font-size: .6rem;
      letter-spacing: .2em;
      text-transform: uppercase;
      color: rgba(255, 255, 255, .25)
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: .75rem;
      padding: .75rem 1.2rem;
      color: rgba(255, 255, 255, .6);
      cursor: pointer;
      transition: all .2s;
      border-radius: 0;
      font-size: .82rem;
      font-weight: 500
    }

    .nav-item:hover,
    .nav-item.active {
      background: rgba(212, 168, 67, .12);
      color: #D4A843;
      padding-left: 1.6rem
    }

    .nav-item .icon {
      font-size: 1rem;
      width: 20px;
      text-align: center
    }

    .sidebar-footer {
      padding: 1.2rem;
      border-top: 1px solid rgba(255, 255, 255, .08);
      font-size: .72rem;
      color: rgba(255, 255, 255, .3);
      text-align: center
    }

    /* MAIN */
    .main {
      margin-left: var(--sidebar-w);
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh
    }

    /* TOPBAR */
    .topbar {
      background: #fff;
      padding: .85rem 1.5rem;
      border-bottom: 1px solid #E8DCC8;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 5
    }

    .topbar h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.4rem;
      font-weight: 400;
      color: #8B6508
    }

    .topbar-actions {
      display: flex;
      align-items: center;
      gap: .75rem
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      padding: .6rem 1.2rem;
      font-size: .75rem;
      font-weight: 600;
      letter-spacing: .06em;
      text-transform: uppercase;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: all .2s;
      text-decoration: none
    }

    .btn-primary {
      background: #B8860B;
      color: #fff
    }

    .btn-primary:hover {
      background: #8B6508
    }

    .btn-danger {
      background: #C0392B;
      color: #fff
    }

    .btn-danger:hover {
      background: #a93226
    }

    .btn-secondary {
      background: #fff;
      color: #1A1A1A;
      border: 1px solid #E8DCC8
    }

    .btn-secondary:hover {
      background: #FAF7F2
    }

    .btn-success {
      background: #27AE60;
      color: #fff
    }

    .btn-success:hover {
      background: #219a52
    }

    .btn-sm {
      padding: .4rem .8rem;
      font-size: .7rem
    }

    /* CONTENT */
    .content {
      flex: 1;
      padding: 1.5rem
    }

    /* STATS */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem
    }

    .stat-card {
      background: #fff;
      border-radius: 8px;
      padding: 1.2rem;
      border: 1px solid #E8DCC8;
      display: flex;
      align-items: center;
      gap: 1rem
    }

    .stat-icon {
      width: 44px;
      height: 44px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      flex-shrink: 0
    }

    .stat-icon.gold {
      background: #FAF0D7
    }

    .stat-icon.green {
      background: #D5F5E3
    }

    .stat-icon.blue {
      background: #D6EAF8
    }

    .stat-icon.red {
      background: #FADBD8
    }

    .stat-val {
      font-size: 1.6rem;
      font-weight: 700;
      line-height: 1
    }

    .stat-label {
      font-size: .72rem;
      color: #6B6B6B;
      letter-spacing: .05em;
      text-transform: uppercase;
      margin-top: .2rem
    }

    /* TOOLBAR */
    .toolbar {
      background: #fff;
      border-radius: 8px;
      border: 1px solid #E8DCC8;
      padding: 1rem;
      margin-bottom: 1rem;
      display: flex;
      gap: .75rem;
      align-items: center;
      flex-wrap: wrap
    }

    .search-input {
      flex: 1;
      min-width: 200px;
      padding: .6rem .9rem;
      border: 1px solid #E8DCC8;
      border-radius: 4px;
      font-size: .85rem;
      background: #FAF7F2
    }

    .search-input:focus {
      outline: none;
      border-color: #B8860B
    }

    .filter-select {
      padding: .6rem .9rem;
      border: 1px solid #E8DCC8;
      border-radius: 4px;
      font-size: .82rem;
      background: #fff
    }

    /* TABLE */
    .table-wrap {
      background: #fff;
      border-radius: 8px;
      border: 1px solid #E8DCC8;
      overflow: hidden
    }

    table {
      width: 100%;
      border-collapse: collapse
    }

    thead {
      background: #FAF7F2
    }

    th {
      padding: .85rem 1rem;
      text-align: left;
      font-size: .68rem;
      font-weight: 700;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: #6B6B6B;
      border-bottom: 2px solid #E8DCC8;
      white-space: nowrap
    }

    td {
      padding: .8rem 1rem;
      border-bottom: 1px solid #F0EDE8;
      vertical-align: middle
    }

    tr:hover td {
      background: #FDFBF8
    }

    tr:last-child td {
      border-bottom: none
    }

    .product-thumb {
      width: 52px;
      height: 52px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid #E8DCC8
    }

    .product-name {
      font-weight: 600;
      font-size: .85rem
    }

    .product-cat {
      font-size: .72rem;
      color: #6B6B6B;
      margin-top: 2px
    }

    .price-val {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1rem;
      font-weight: 600;
      color: #8B6508
    }

    .price-old {
      font-size: .72rem;
      color: #999;
      text-decoration: line-through;
      display: block
    }

    .badge {
      display: inline-block;
      padding: .2rem .6rem;
      border-radius: 100px;
      font-size: .65rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: .05em
    }

    .badge-hit {
      background: #FEF3C7;
      color: #92400E
    }

    .badge-new {
      background: #D1FAE5;
      color: #065F46
    }

    .badge-sale {
      background: #FEE2E2;
      color: #991B1B
    }

    .badge-none {
      background: #F3F4F6;
      color: #6B6B6B
    }

    .stock-on {
      color: #27AE60;
      font-weight: 600;
      font-size: .78rem
    }

    .stock-off {
      color: #C0392B;
      font-weight: 600;
      font-size: .78rem
    }

    .action-btns {
      display: flex;
      gap: .4rem
    }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: #6B6B6B
    }

    .empty-state .emoji {
      font-size: 2.5rem;
      margin-bottom: .75rem
    }

    /* MODAL */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .5);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      opacity: 0;
      visibility: hidden;
      transition: all .2s
    }

    .modal-overlay.open {
      opacity: 1;
      visibility: visible
    }

    .modal {
      background: #fff;
      border-radius: 12px;
      width: 100%;
      max-width: 640px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, .2)
    }

    .modal-header {
      padding: 1.2rem 1.5rem;
      border-bottom: 1px solid #E8DCC8;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      background: #fff;
      z-index: 1
    }

    .modal-header h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.4rem;
      font-weight: 400;
      color: #8B6508
    }

    .modal-close {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: #F4F6FA;
      border: none;
      cursor: pointer;
      font-size: 1.1rem;
      color: #6B6B6B
    }

    .modal-close:hover {
      background: #E8DCC8
    }

    .modal-body {
      padding: 1.5rem
    }

    .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid #E8DCC8;
      display: flex;
      justify-content: flex-end;
      gap: .75rem;
      background: #FAF7F2;
      border-radius: 0 0 12px 12px
    }

    /* FORM */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem
    }

    .form-group {
      margin-bottom: 0
    }

    .form-group.full {
      grid-column: 1/-1
    }

    label {
      display: block;
      font-size: .72rem;
      font-weight: 600;
      letter-spacing: .08em;
      text-transform: uppercase;
      color: #6B6B6B;
      margin-bottom: .4rem
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: .65rem .9rem;
      border: 1px solid #E8DCC8;
      border-radius: 4px;
      font-size: .88rem;
      background: #FAF7F2;
      color: #1A1A1A;
      font-family: 'Inter', sans-serif;
      transition: border-color .2s
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #B8860B;
      background: #fff
    }

    textarea {
      resize: vertical;
      min-height: 90px
    }

    .img-preview {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid #E8DCC8;
      margin-top: .5rem;
      display: none
    }

    .img-preview.show {
      display: block
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: #1A1A1A;
      color: #fff;
      padding: .8rem 1.5rem;
      border-radius: 8px;
      font-size: .82rem;
      font-weight: 500;
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all .25s;
      display: flex;
      align-items: center;
      gap: .5rem;
      white-space: nowrap
    }

    .toast.show {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0)
    }

    /* Confirm Dialog */
    .confirm-dialog {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .5);
      z-index: 200;
      align-items: center;
      justify-content: center
    }

    .confirm-dialog.open {
      display: flex
    }

    .confirm-box {
      background: #fff;
      border-radius: 10px;
      padding: 2rem;
      max-width: 380px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, .2)
    }

    .confirm-box h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.3rem;
      margin-bottom: .75rem;
      color: #C0392B
    }

    .confirm-box p {
      font-size: .85rem;
      color: #6B6B6B;
      margin-bottom: 1.5rem;
      line-height: 1.6
    }

    .confirm-box .actions {
      display: flex;
      gap: .75rem;
      justify-content: center
    }

    @media(max-width:768px) {
      .sidebar {
        display: none
      }

      .main {
        margin-left: 0
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr)
      }

      .form-grid {
        grid-template-columns: 1fr
      }
    }
  </style>
</head>

<body>

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="name">Altyn Biye</div>
      <div class="sub">Admin Panel</div>
    </div>
    <nav class="sidebar-nav">
      <div class="nav-section">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
      <div class="nav-item active" id="nav-products" onclick="showSection('products')"><span class="icon">üíé</span>
        –¢–æ–≤–∞—Ä—ã</div>
      <div class="nav-item" id="nav-categories" onclick="showSection('categories')"><span class="icon">üè∑Ô∏è</span>
        –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
      <div class="nav-item" id="nav-attributes" onclick="showSection('attributes')"><span class="icon">‚ú®</span>
        –ê—Ç—Ä–∏–±—É—Ç—ã</div>
      <div class="nav-item" onclick="showSection('stats')"><span class="icon">üìä</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
      <div class="nav-section">–°–∞–π—Ç</div>
      <div class="nav-item" onclick="window.open('/','_blank')"><span class="icon">üè†</span> –ì–ª–∞–≤–Ω–∞—è</div>
      <div class="nav-item" onclick="window.open('/catalog.html','_blank')"><span class="icon">üì¶</span> –ö–∞—Ç–∞–ª–æ–≥</div>
    </nav>
    <div class="sidebar-footer">Altyn Biye ¬© 2024</div>
  </aside>

  <!-- MAIN -->
  <div class="main">
    <div class="topbar">
      <h1 id="page-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h1>
      <div class="topbar-actions">
        <button class="btn btn-primary" onclick="openAddModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
        <a href="/catalog.html" target="_blank" class="btn btn-secondary">‚Üó –ö–∞—Ç–∞–ª–æ–≥</a>
      </div>
    </div>

    <!-- PRODUCTS SECTION -->
    <div class="content" id="section-products">
      <!-- Stats row -->
      <div class="stats-grid" id="stats-grid">
        <div class="stat-card">
          <div class="stat-icon gold">üíé</div>
          <div>
            <div class="stat-val" id="stat-total">‚Äî</div>
            <div class="stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon green">‚úÖ</div>
          <div>
            <div class="stat-val" id="stat-instock">‚Äî</div>
            <div class="stat-label">–í –Ω–∞–ª–∏—á–∏–∏</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon blue">üè∑Ô∏è</div>
          <div>
            <div class="stat-val" id="stat-cats">‚Äî</div>
            <div class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon red">üî•</div>
          <div>
            <div class="stat-val" id="stat-sale">‚Äî</div>
            <div class="stat-label">–†–∞—Å–ø—Ä–æ–¥–∞–∂–∞</div>
          </div>
        </div>
      </div>

      <!-- Toolbar -->
      <div class="toolbar">
        <input class="search-input" id="search-input" placeholder="üîç  –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –º–∞—Ç–µ—Ä–∏–∞–ª—É..."
          oninput="filterTable()">
        <select class="filter-select" id="filter-cat" onchange="filterTable()">
          <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
          <option value="necklaces">–û–∂–µ—Ä–µ–ª—å—è</option>
          <option value="earrings">–°–µ—Ä—å–≥–∏</option>
          <option value="bracelets">–ë—Ä–∞—Å–ª–µ—Ç—ã</option>
          <option value="rings">–ö–æ–ª—å—Ü–∞</option>
          <option value="headpieces">–ì–æ–ª–æ–≤–Ω—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è</option>
          <option value="sets">–°–≤–∞–¥–µ–±–Ω—ã–µ –Ω–∞–±–æ—Ä—ã</option>
        </select>
        <select class="filter-select" id="filter-badge" onchange="filterTable()">
          <option value="">–í—Å–µ –º–µ—Ç–∫–∏</option>
          <option value="hit">–•–∏—Ç</option>
          <option value="new">–ù–æ–≤–∏–Ω–∫–∞</option>
          <option value="sale">–°–∫–∏–¥–∫–∞</option>
        </select>
        <select class="filter-select" id="filter-stock" onchange="filterTable()">
          <option value="">–õ—é–±–æ–π —Å—Ç–∞—Ç—É—Å</option>
          <option value="1">–í –Ω–∞–ª–∏—á–∏–∏</option>
          <option value="0">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</option>
        </select>
        <button class="btn btn-secondary btn-sm" onclick="clearFilters()">–°–±—Ä–æ—Å–∏—Ç—å</button>
      </div>

      <!-- Table -->
      <div class="table-wrap">
        <table id="products-table">
          <thead>
            <tr>
              <th>–§–æ—Ç–æ</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
              <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
              <th>–¶–µ–Ω–∞</th>
              <th>–ú–µ—Ç–∫–∞</th>
              <th>–ú–µ—Ç–∞–ª–ª</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody id="table-body">
            <tr>
              <td colspan="8">
                <div class="empty-state">
                  <div class="emoji">‚è≥</div>–ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- CATEGORIES SECTION -->
    <div class="content" id="section-categories" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:400;color:#8B6508">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
          –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h2>
        <button class="btn btn-primary" onclick="window.adminCategories.openModal()">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>–§–æ—Ç–æ</th>
              <th>ID</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ RU</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ KZ</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody id="cat-table-body">
            <tr>
              <td colspan="5">
                <div class="empty-state">
                  <div class="emoji">‚è≥</div>–ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ATTRIBUTES SECTION -->
    <div class="content" id="section-attributes" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:400;color:#8B6508">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
          –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏</h2>
        <button class="btn btn-primary" onclick="window.adminAttributes.openModal()">+ –î–æ–±–∞–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç</button>
      </div>

      <!-- Toolbar -->
      <div class="toolbar">
        <input class="search-input" id="search-attr" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..."
          oninput="window.adminAttributes.filterTable()">
        <select class="filter-select" id="filter-attr-type" onchange="window.adminAttributes.filterTable()">
          <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
          <option value="metal">–ú–µ—Ç–∞–ª–ª</option>
          <option value="stone">–ö–∞–º–µ–Ω—å</option>
          <option value="badge">–ú–µ—Ç–∫–∞</option>
        </select>
        <button class="btn btn-secondary btn-sm" onclick="window.adminAttributes.clearFilters()">–°–±—Ä–æ—Å–∏—Ç—å</button>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>–¢–∏–ø</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ RU</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ KZ</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody id="attr-table-body">
            <tr>
              <td colspan="5">
                <div class="empty-state">
                  <div class="emoji">‚è≥</div>–ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- CATEGORY MODAL -->
  <div class="modal-overlay" id="cat-modal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="cat-modal-title">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>
        <button class="modal-close" onclick="window.adminCategories.closeModal()">‚úï</button>
      </div>
      <form class="modal-body" id="cat-form">
        <input type="hidden" id="cat-edit-id">
        <div class="form-grid">
          <div class="form-group">
            <label>ID (slug) *</label>
            <input type="text" id="cat-id" placeholder="necklaces" required>
          </div>
          <div class="form-group"></div>
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ RU *</label>
            <input type="text" id="cat-name" placeholder="–û–∂–µ—Ä–µ–ª—å—è" required>
          </div>
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ KZ *</label>
            <input type="text" id="cat-name-kz" placeholder="–ú–æ–Ω—à–∞“õ—Ç–∞—Ä" required>
          </div>
          <div class="form-group full">
            <label>–§–æ—Ç–æ (URL)</label>
            <input type="text" id="cat-img" placeholder="/images/category_necklaces.png">
          </div>
        </div>
      </form>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="window.adminCategories.closeModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" onclick="window.adminCategories.save()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- ATTRIBUTE MODAL -->
  <div class="modal-overlay" id="attr-modal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="attr-modal-title">–î–æ–±–∞–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç</h2>
        <button class="modal-close" onclick="window.adminAttributes.closeModal()">‚úï</button>
      </div>
      <form class="modal-body" id="attr-form">
        <input type="hidden" id="attr-edit-id">
        <div class="form-grid">
          <div class="form-group">
            <label>ID (slug) *</label>
            <input type="text" id="attr-id" placeholder="gold585" required>
          </div>
          <div class="form-group">
            <label>–¢–∏–ø *</label>
            <select id="attr-type" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
              <option value="metal">–ú–µ—Ç–∞–ª–ª</option>
              <option value="stone">–ö–∞–º–µ–Ω—å</option>
              <option value="badge">–ú–µ—Ç–∫–∞</option>
            </select>
          </div>
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ RU *</label>
            <input type="text" id="attr-name" placeholder="–ó–æ–ª–æ—Ç–æ 585" required>
          </div>
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ KZ *</label>
            <input type="text" id="attr-name-kz" placeholder="–ê–ª—Ç—ã–Ω 585" required>
          </div>
          <div class="form-group full">
            <label>–¶–≤–µ—Ç (–¥–ª—è –º–µ—Ç–æ–∫)</label>
            <input type="color" id="attr-color" value="#CCCCCC">
          </div>
        </div>
      </form>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="window.adminAttributes.closeModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" id="btn-attr-save" onclick="window.adminAttributes.save(event)">üíæ
          –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- ADD / EDIT PRODUCT MODAL -->
  <div class="modal-overlay" id="product-modal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>
        <button class="modal-close" onclick="closeModal()">‚úï</button>
      </div>
      <form class="modal-body" id="product-form" enctype="multipart/form-data">
        <input type="hidden" id="edit-id">
        <div class="form-grid">
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ (RU) *</label>
            <input type="text" id="f-name" placeholder="–ê–ª—Ç—ã–Ω –ú–æ–Ω—à–∞“õ" required>
          </div>
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ (KZ)</label>
            <input type="text" id="f-name-kz" placeholder="–ê–ª—Ç—ã–Ω –ú–æ–Ω—à–∞“õ">
          </div>
          <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
            <select id="f-category" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
            </select>
          </div>
          <div class="form-group">
            <label>–†–µ–π—Ç–∏–Ω–≥ (1-5)</label>
            <input type="number" id="f-rating" value="5" min="1" max="5" step="0.1">
          </div>
          <div class="form-group">
            <label>–¶–µ–Ω–∞ (‚Ç∏) *</label>
            <input type="number" id="f-price" placeholder="85000" min="0" required>
          </div>
          <div class="form-group">
            <label>–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞ (‚Ç∏)</label>
            <input type="number" id="f-old-price" placeholder="100000" min="0">
          </div>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>–ú–µ—Ç–∞–ª–ª</label>
            <select id="p-metal">
              <option value="">–ë–µ–∑ –º–µ—Ç–∞–ª–ª–∞</option>
            </select>
          </div>
          <div class="form-group">
            <label>–ö–∞–º–µ–Ω—å</label>
            <select id="p-stone">
              <option value="">–ë–µ–∑ –∫–∞–º–Ω—è</option>
            </select>
          </div>
          <div class="form-group">
            <label>–ú–∞—Ç–µ—Ä–∏–∞–ª (–°–±–æ—Ä–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)</label>
            <input type="text" id="p-material" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–æ–ª–æ—Ç–æ 585 ¬∑ –ë–∏—Ä—é–∑–∞">
          </div>
          <div class="form-group">
            <label>–ú–µ—Ç–∫–∞</label>
            <select id="p-badge">
              <option value="">–ù–µ—Ç –º–µ—Ç–∫–∏</option>
            </select>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group full">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ (RU)</label>
            <textarea id="p-desc" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..."></textarea>
          </div>
          <div class="form-group full">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ (KZ)</label>
            <textarea id="p-desc-kz" placeholder="–¢–æ–≤–∞—Ä–¥—ã“£ “õ—ã—Å“õ–∞—à–∞ —Å–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã..."></textarea>
          </div>
        </div>
        <div class="form-group full">
          <label>–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞</label>
          <input type="file" id="f-img" accept="image/*" onchange="previewImg(this)">
          <img id="img-preview" class="img-preview" alt="Preview">
          <div style="margin-top:.4rem">
            <label>–ò–ª–∏ URL —Ñ–æ—Ç–æ</label>
            <input type="text" id="f-img-url" placeholder="/images/category_necklaces.png">
          </div>
        </div>
        <div class="form-group">
          <label>–í –Ω–∞–ª–∏—á–∏–∏</label>
          <select id="f-stock">
            <option value="1">–î–∞</option>
            <option value="0">–ù–µ—Ç</option>
          </select>
        </div>
    </div>
    </form>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn btn-primary" onclick="saveProduct()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
  </div>

  <!-- CONFIRM DIALOG -->
  <div class="confirm-dialog" id="confirm-dialog">
    <div class="confirm-box">
      <h3>‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ</h3>
      <p id="confirm-text">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.</p>
      <div class="actions">
        <button class="btn btn-secondary" onclick="closeConfirm()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-danger" id="confirm-ok" onclick="">–£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast"></div>

  <script>
    const API = '/api/products';
    // const CAT_NAMES = { necklaces: '–û–∂–µ—Ä–µ–ª—å—è', earrings: '–°–µ—Ä—å–≥–∏', bracelets: '–ë—Ä–∞—Å–ª–µ—Ç—ã', rings: '–ö–æ–ª—å—Ü–∞', headpieces: '–ì–æ–ª–æ–≤–Ω—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è', sets: '–°–≤–∞–¥–µ–±–Ω—ã–µ –Ω–∞–±–æ—Ä—ã' };
    // const BADGE_CLS = { hit: 'badge-hit', new: 'badge-new', sale: 'badge-sale', '': { class: 'badge-none', label: '‚Äî' } };
    // const BADGE_LABELS = { hit: '–•–∏—Ç', new: '–ù–æ–≤–∏–Ω–∫–∞', sale: '–°–∫–∏–¥–∫–∞', '': { label: '‚Äî' } };

    let allProducts = [];
    let allCategories = []; // Global for products section
    let allAttributes = []; // Global for products section

    // ‚îÄ‚îÄ FETCH & RENDER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function loadProducts() {
      try {
        const res = await fetch(API);
        const json = await res.json();
        allProducts = json.data || [];
        renderTable(allProducts);
        loadStats();
      } catch (e) {
        document.getElementById('table-body').innerHTML =
          `<tr><td colspan="8"><div class="empty-state"><div class="emoji">‚ùå</div>–û—à–∏–±–∫–∞: —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω<br><small>node server/index.js</small></div></td></tr>`;
      }
    }

    async function loadStats() {
      try {
        const res = await fetch('/api/products/stats');
        const { data } = await res.json();
        document.getElementById('stat-total').textContent = data.total;
        document.getElementById('stat-instock').textContent = data.inStock;
        document.getElementById('stat-cats').textContent = data.byCategory.length;
        const saleCount = allProducts.filter(p => p.badge === 'sale').length;
        document.getElementById('stat-sale').textContent = saleCount;
      } catch (e) { }
    }

    function renderTable(products) {
      const tbody = document.getElementById('table-body');
      if (!products.length) {
        tbody.innerHTML = `<tr><td colspan="8"><div class="empty-state"><div class="emoji">üì¶</div>–¢–æ–≤–∞—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div></td></tr>`;
        return;
      }
      tbody.innerHTML = products.map(p => {
        const category = allCategories.find(c => c.id === p.category);
        const metal = allAttributes.find(a => a.type === 'metal' && a.id === p.metal);
        const badge = allAttributes.find(a => a.type === 'badge' && a.id === p.badge);
        const badgeClass = badge ? `badge-${badge.id}` : 'badge-none';
        const badgeLabel = badge ? badge.name : '‚Äî';

        return `
    <tr>
      <td><img class="product-thumb" src="${p.img || '/images/category_sets.png'}" alt="${p.name}" onerror="this.src='/images/category_sets.png'"></td>
      <td>
        <div class="product-name">${p.name}</div>
        <div class="product-cat">${p.material || ''}</div>
      </td>
      <td>${category ? category.name : p.category}</td>
      <td>
        <div class="price-val">${p.price.toLocaleString('ru-KZ')} ‚Ç∏</div>
        ${p.old_price ? `<span class="price-old">${p.old_price.toLocaleString('ru-KZ')} ‚Ç∏</span>` : ''}
      </td>
      <td>${p.badge ? `<span class="badge ${badgeClass}" style="background:${badge?.color || ''}">${badgeLabel}</span>` : `<span class="badge badge-none">‚Äî</span>`}</td>
      <td>${metal ? metal.name : p.metal || '‚Äî'}</td>
      <td class="${p.in_stock ? 'stock-on' : 'stock-off'}">${p.in_stock ? '‚úÖ –ï—Å—Ç—å' : '‚ùå –ù–µ—Ç'}</td>
      <td>
        <div class="action-btns">
          <button class="btn btn-secondary btn-sm" onclick="openEditModal('${p.id}')">‚úèÔ∏è</button>
          <button class="btn btn-danger btn-sm" onclick="confirmDelete('${p.id}','${p.name.replace(/'/g, "\\'")}')">üóëÔ∏è</button>
        </div>
      </td>
    </tr>`}).join('');
    }

    // function metalLabel(m) { const map = { gold585: '–ó–æ–ª. 585', gold750: '–ó–æ–ª. 750', silver: '–°–µ—Ä–µ–±—Ä–æ' }; return map[m] || m }

    // ‚îÄ‚îÄ FILTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function filterTable() {
      const q = document.getElementById('search-input').value.toLowerCase();
      const cat = document.getElementById('filter-cat').value;
      const badge = document.getElementById('filter-badge').value;
      const stock = document.getElementById('filter-stock').value;
      const filtered = allProducts.filter(p => {
        if (q && !p.name.toLowerCase().includes(q) && !(p.material || '').toLowerCase().includes(q)) return false;
        if (cat && p.category !== cat) return false;
        if (badge && p.badge !== badge) return false;
        if (stock !== '' && String(p.in_stock) !== stock) return false;
        return true;
      });
      renderTable(filtered);
    }
    function clearFilters() {
      document.getElementById('search-input').value = '';
      document.getElementById('filter-cat').value = '';
      document.getElementById('filter-badge').value = '';
      document.getElementById('filter-stock').value = '';
      renderTable(allProducts);
    }

    // ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function populateProductSelectors() {
      const categories = await fetch('/api/categories').then(res => res.json()).then(data => data.data || []);
      allCategories = categories; // Store globally
      const categorySelect = document.getElementById('f-category');
      categorySelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>' + categories.map(c => `<option value="${c.id}">${c.name}</option>`).join('');

      const attributes = await fetch('/api/attributes').then(res => res.json()).then(data => data.data || []);
      allAttributes = attributes; // Store globally

      const metalSelect = document.getElementById('p-metal');
      const stoneSelect = document.getElementById('p-stone');
      const badgeSelect = document.getElementById('p-badge');
      const filterCatSelect = document.getElementById('filter-cat');
      const filterBadgeSelect = document.getElementById('filter-badge');

      metalSelect.innerHTML = '<option value="">–ë–µ–∑ –º–µ—Ç–∞–ª–ª–∞</option>' + attributes.filter(a => a.type === 'metal').map(a => `<option value="${a.id}">${a.name}</option>`).join('');
      stoneSelect.innerHTML = '<option value="">–ë–µ–∑ –∫–∞–º–Ω—è</option>' + attributes.filter(a => a.type === 'stone').map(a => `<option value="${a.id}">${a.name}</option>`).join('');
      badgeSelect.innerHTML = '<option value="">–ù–µ—Ç –º–µ—Ç–∫–∏</option>' + attributes.filter(a => a.type === 'badge').map(a => `<option value="${a.id}">${a.name}</option>`).join('');

      filterCatSelect.innerHTML = '<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>' + categories.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
      filterBadgeSelect.innerHTML = '<option value="">–í—Å–µ –º–µ—Ç–∫–∏</option>' + attributes.filter(a => a.type === 'badge').map(a => `<option value="${a.id}">${a.name}</option>`).join('');
    }

    function openAddModal() {
      document.getElementById('modal-title').textContent = '–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';
      document.getElementById('edit-id').value = '';
      document.getElementById('product-form').reset();
      document.getElementById('img-preview').classList.remove('show');
      document.getElementById('product-modal').classList.add('open');
      populateProductSelectors();
    }

    async function openEditModal(id) {
      const p = allProducts.find(x => x.id === id);
      if (!p) return;
      document.getElementById('modal-title').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä';
      document.getElementById('edit-id').value = id;
      document.getElementById('f-name').value = p.name;
      document.getElementById('f-name-kz').value = p.name_kz || '';
      document.getElementById('f-category').value = p.category;
      document.getElementById('f-price').value = p.price;
      document.getElementById('f-old-price').value = p.old_price || '';
      document.getElementById('f-rating').value = p.rating || 5;
      document.getElementById('f-stock').value = p.in_stock ? '1' : '0';

      // Populate dynamic selectors
      await populateProductSelectors();
      document.getElementById('p-metal').value = p.metal || '';
      document.getElementById('p-stone').value = p.stone || '';
      document.getElementById('p-badge').value = p.badge || '';

      document.getElementById('p-material').value = p.material || '';
      document.getElementById('p-desc').value = p.description || '';
      document.getElementById('p-desc-kz').value = p.description_kz || '';
      document.getElementById('f-img-url').value = p.img || '';
      const preview = document.getElementById('img-preview');
      if (p.img) { preview.src = p.img; preview.classList.add('show'); }
      else preview.classList.remove('show');
      document.getElementById('product-modal').classList.add('open');
    }

    function closeModal() {
      document.getElementById('product-modal').classList.remove('open');
    }

    async function saveProduct() {
      const id = document.getElementById('edit-id').value;
      const form = document.getElementById('product-form');
      const fd = new FormData();
      fd.append('name', document.getElementById('f-name').value);
      fd.append('name_kz', document.getElementById('f-name-kz').value);
      fd.append('category', document.getElementById('f-category').value);
      fd.append('badge', document.getElementById('p-badge').value);
      fd.append('price', document.getElementById('f-price').value);
      fd.append('old_price', document.getElementById('f-old-price').value);
      fd.append('metal', document.getElementById('p-metal').value);
      fd.append('stone', document.getElementById('p-stone').value);
      fd.append('rating', document.getElementById('f-rating').value);
      fd.append('in_stock', document.getElementById('f-stock').value);
      fd.append('material', document.getElementById('p-material').value);
      fd.append('description', document.getElementById('p-desc').value);
      fd.append('description_kz', document.getElementById('p-desc-kz').value);
      fd.append('img_url', document.getElementById('f-img-url').value);
      const imgFile = document.getElementById('f-img').files[0];
      if (imgFile) fd.append('img', imgFile);

      if (!fd.get('name') || !fd.get('category') || !fd.get('price')) {
        showToast('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
        return;
      }

      try {
        const url = id ? `${API}/${id}` : API;
        const method = id ? 'PUT' : 'POST';
        const res = await fetch(url, { method, body: fd });
        const json = await res.json();
        if (!json.success) throw new Error(json.error);
        closeModal();
        await loadProducts();
        showToast(id ? '‚úÖ –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω' : '‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω');
      } catch (e) {
        showToast('‚ùå –û—à–∏–±–∫–∞: ' + e.message);
      }
    }

    function previewImg(input) {
      const preview = document.getElementById('img-preview');
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = e => { preview.src = e.target.result; preview.classList.add('show'); };
        reader.readAsDataURL(input.files[0]);
      }
    }

    // ‚îÄ‚îÄ DELETE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let pendingDeleteId = null;
    function confirmDelete(id, name) {
      pendingDeleteId = id;
      document.getElementById('confirm-text').textContent = `–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä "${name}"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.`;
      document.getElementById('confirm-dialog').classList.add('open');
      document.getElementById('confirm-ok').onclick = deleteProduct;
    }
    function closeConfirm() {
      document.getElementById('confirm-dialog').classList.remove('open');
      pendingDeleteId = null;
    }
    async function deleteProduct() {
      if (!pendingDeleteId) return;
      try {
        const res = await fetch(`${API}/${pendingDeleteId}`, { method: 'DELETE' });
        const json = await res.json();
        if (!json.success) throw new Error(json.error);
        closeConfirm();
        await loadProducts();
        showToast('‚úÖ –¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω');
      } catch (e) {
        showToast('‚ùå –û—à–∏–±–∫–∞: ' + e.message);
        closeConfirm();
      }
    }

    // ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function showSection(sec) {
      // Hide all sections
      document.getElementById('section-products').style.display = 'none';
      document.getElementById('section-categories').style.display = 'none';
      document.getElementById('section-attributes').style.display = 'none';
      // document.getElementById('section-stats').style.display = 'none'; // If you have a stats section

      // Show active section
      const activeSection = document.getElementById(`section-${sec}`);
      if (activeSection) activeSection.style.display = '';

      // Update sidebar active state
      document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      const navEl = document.getElementById('nav-' + sec);
      if (navEl) navEl.classList.add('active');

      // Update topbar title & action button
      const pageTitle = document.getElementById('page-title');
      const actions = document.querySelector('.topbar-actions');
      let title = '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è';

      if (sec === 'products') {
        title = '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏';
        actions.innerHTML = `
          <button class="btn btn-primary" onclick="openAddModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
          <a href="/catalog.html" target="_blank" class="btn btn-secondary">‚Üó –ö–∞—Ç–∞–ª–æ–≥</a>
        `;
        await populateProductSelectors(); // Load categories and attributes for product filters
        loadProducts();
      } else if (sec === 'categories') {
        title = '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏';
        actions.innerHTML = `
          <button class="btn btn-primary" onclick="window.adminCategories.openModal()">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
        `;
        window.adminCategories.load();
      } else if (sec === 'attributes') {
        title = '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏';
        actions.innerHTML = `
          <button class="btn btn-primary" onclick="window.adminAttributes.openModal()">+ –î–æ–±–∞–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç</button>
        `;
        window.adminAttributes.load();
      } else if (sec === 'stats') {
        title = '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞';
        actions.innerHTML = ''; // No specific actions for stats for now
      }

      pageTitle.textContent = title;
    }

    // ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let toastTimer;
    function showToast(msg) {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => t.classList.remove('show'), 3500);
    }

    // ‚îÄ‚îÄ KEYBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') { closeModal(); closeConfirm(); window.adminCategories.closeModal(); window.adminAttributes.closeModal(); }
    });

    // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    showSection('products'); // Initial load
  </script>
  <script src="/js/admin-attributes.js"></script>
  <script src="/js/admin-categories.js"></script>
</body>

</html>